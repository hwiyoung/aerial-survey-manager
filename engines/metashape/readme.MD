# Metashape Processing Engine

ν•­κ³µμΈ΅λ‰ λ§¤λ‹μ € ν”λ«νΌμ κ³ μ„±λ¥ μ •μ‚¬μμƒ μ²λ¦¬ μ—”μ§„μ…λ‹λ‹¤. Agisoft Metashape Professional Python SDKλ¥Ό κΈ°λ°μΌλ΅ λ™μ‘ν•©λ‹λ‹¤.

## π€ Key Features
- **GPU Acceleration**: NVIDIA CUDA κ°€μ†μ„ ν†µν• κ³ μ† λ§¤μΉ­ λ° ν¬μΈνΈ ν΄λΌμ°λ“ μƒμ„±
- **Celery Integration**: λ¶„μ‚° μ²λ¦¬ νλ¥Ό ν†µν• λΉ„λ™κΈ° μ‘μ—… κ΄€λ¦¬
- **License Persistence**: Docker λ³Όλ¥¨ λ° κ³ μ • MAC μ£Όμ†λ¥Ό ν™μ©ν• μ•μ •μ μΈ λΌμ΄μ„ μ¤ μ μ§€

## π›  Setup & Licensing

### 1. Environment Setup
`.env` νμΌμ— λΌμ΄μ„ μ¤ ν‚¤ λ° ν•λ“μ›¨μ–΄ μ„¤μ •μ„ μ…λ ¥ν•©λ‹λ‹¤.

```env
METASHAPE_LICENSE_KEY=XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
```

### 2. License Activation
μ»¨ν…μ΄λ„ μ‹¤ν–‰ ν›„ μµμ΄ 1ν ν™μ„±ν™”κ°€ ν•„μ”ν•©λ‹λ‹¤.

```bash
docker exec worker-metashape python3 /app/engines/metashape/dags/metashape/activate.py
```

### 3. Verification
ν™μ„±ν™” μƒνƒλ¥Ό ν™•μΈν•λ ¤λ©΄ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
```bash
docker exec worker-metashape python3 -c "import Metashape; print(Metashape.License().valid)"
```

## π“ Structure
- `dags/`: Airflow νΈν™μ© DAG νμΌ (Celery Workerμ—μ„λ„ κ³µμ λ¨)
- `dags/metashape/`: μ‹¤μ  Metashape μ²λ¦¬ λ΅μ§ λ° κ³µν†µ μ ν‹Έλ¦¬ν‹°
- `Dockerfile`: CUDA 12.0 κΈ°λ° Metashape λ°νƒ€μ„ μ΄λ―Έμ§€

## β οΈ Notes
- Metashape 2.2.0 λ²„μ „μ„ μ‚¬μ©ν•λ©°, λΌμ΄μ„ μ¤ μ²΄ν¬ μ‹ `.valid` μ†μ„±μ„ μ‚¬μ©ν•©λ‹λ‹¤.
- λΌμ΄μ„ μ¤ νμΌμ€ `/var/tmp/agisoft/licensing` κ²½λ΅μ— μ €μ¥λλ„λ΅ μ„¤μ •λμ–΄ μμµλ‹λ‹¤.
