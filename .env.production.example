# ============================================================
# Aerial Survey Manager - Production Environment Configuration
# 외부 기관 배포용 환경 설정 파일
# ============================================================
#
# 사용법:
#   1. 이 파일을 .env로 복사: cp .env.production.example .env
#   2. 아래 변수들을 실제 환경에 맞게 수정
#   3. docker compose -f docker-compose.prod.yml up -d
#
# 또는 설치 스크립트 사용: ./scripts/install.sh
#

# ============================================================
# Docker Compose 프로젝트명 (변경하지 마세요)
# 이 값이 고정되어야 버전 업그레이드 시 DB/볼륨이 유지됩니다.
# ============================================================
COMPOSE_PROJECT_NAME=aerial-survey-manager

# ============================================================
# [필수] 보안 설정 - 반드시 변경하세요!
# ============================================================

# PostgreSQL 데이터베이스 비밀번호
# 생성 방법: openssl rand -base64 24
POSTGRES_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD

# JWT 인증 서명 키 (최소 32자 이상)
# 생성 방법: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE_THIS_TO_AT_LEAST_32_CHARACTER_SECRET_KEY

# ============================================================
# [필수] 스토리지 설정
# ============================================================
# "local" = 로컬 디스크 (단일 서버, MinIO 없이 운영)
# "minio" = MinIO/S3 (멀티 서버 또는 S3 호환 스토리지)
#
# 로컬 모드 (기본값, 단일 서버 권장):
#   - 파일이 로컬 디스크에 직접 저장됨
#   - MinIO 불필요 → 리소스 절약, 처리 속도 향상
#
# MinIO 모드:
#   - 별도 S3 스토리지 서비스 사용
#   - 멀티 서버 또는 클라우드 환경에 적합
#   - COMPOSE_PROFILES=minio 으로 MinIO 서비스 활성화 필요
STORAGE_BACKEND=local

# MinIO (S3 호환 저장소) 인증 정보 (STORAGE_BACKEND=minio 일 때만 필요)
MINIO_ACCESS_KEY=aerial-admin
# 생성 방법: openssl rand -base64 32
MINIO_SECRET_KEY=CHANGE_THIS_TO_SECURE_MINIO_SECRET

# ============================================================
# [필수] 네트워크 설정
# ============================================================

# 접속 도메인 (DNS 또는 IP)
# 예: app.example.com 또는 192.168.1.100
DOMAIN=localhost

# 웹 서비스 포트
WEB_PORT=8081

# MinIO Public Endpoint (STORAGE_BACKEND=minio 일 때만 필요)
# 브라우저에서 접근하는 주소와 동일해야 함
# 형식: {DOMAIN}:{WEB_PORT} 또는 도메인만 (80/443 포트 사용 시)
MINIO_PUBLIC_ENDPOINT=localhost:8081

# ============================================================
# [필수] 저장소 경로 설정
# ============================================================
# 주의: 대용량 디스크 경로로 설정하세요 (최소 1TB 이상 권장)
#
# 저장 구조 (로컬 모드):
#   LOCAL_STORAGE_PATH/images/       ← 업로드된 이미지
#   LOCAL_STORAGE_PATH/projects/     ← 정사영상 결과물
#   PROCESSING_DATA_PATH/            ← 처리 임시 파일
#   TILES_PATH/                      ← 오프라인 지도 타일
#
# 저장 구조 (MinIO 모드):
#   MINIO_DATA_PATH/aerial-survey/   ← MinIO 버킷
#   PROCESSING_DATA_PATH/            ← 처리 임시 파일
#   TILES_PATH/                      ← 오프라인 지도 타일

# 로컬 스토리지 경로 (STORAGE_BACKEND=local 일 때)
LOCAL_STORAGE_PATH=/data/storage

# MinIO 데이터 경로 (STORAGE_BACKEND=minio 일 때)
MINIO_DATA_PATH=/data

# 처리 작업 경로 (임시 파일, 처리 중간 결과물)
PROCESSING_DATA_PATH=/data/processing

# 오프라인 타일맵 경로 (배경지도 타일)
TILES_PATH=/data/tiles

# ============================================================
# [필수] 라이선스 설정
# ============================================================

# 처리 엔진 라이선스 키 (정사영상 처리용)
# 라이선스가 없으면 처리 기능을 사용할 수 없습니다
ENGINE_LICENSE_KEY=

# ============================================================
# [선택] 외부 처리 엔진 (External API)
# ============================================================
# 외부 처리 엔진을 사용하는 경우에만 설정

# EXTERNAL_ENGINE_URL=https://external-engine.example.com
# EXTERNAL_ENGINE_API_KEY=your-external-api-key

# ============================================================
# [선택] 고급 설정
# ============================================================

# PostgreSQL 포트 (기본값: 5434)
# DB_PORT=5434

# Redis 포트 (기본값: 6380)
# REDIS_PORT=6380

# MinIO API 포트 (기본값: 9002)
# MINIO_API_PORT=9002

# MinIO Console 포트 (기본값: 9003)
# MINIO_CONSOLE_PORT=9003

# Flower 모니터링 포트 (기본값: 5555)
# FLOWER_PORT=5555

# ============================================================
# [선택] 오프라인 지도 설정
# ============================================================
# 인터넷 없이 지도를 표시하려면 오프라인 타일 데이터가 필요합니다.
# 타일 형식: {TILES_PATH}/{z}/{x}/{y}.jpg 또는 .png (OSM 형식)
# TILES_PATH는 위의 저장소 경로 설정에서 지정합니다.
#
# 프로덕션 기본값: true (오프라인 모드)
# 개발환경 기본값: false (온라인 모드 - OpenStreetMap 사용)

# 오프라인 타일맵 사용 여부 (true/false)
# 프로덕션에서는 기본값이 true입니다 (인터넷 없는 환경 고려)
VITE_MAP_OFFLINE=true

# 오프라인 타일 URL 패턴 (기본값 사용 권장)
# 기본값: /tiles/{z}/{x}/{y} (확장자 없음 - nginx가 .jpg/.png 자동 감지)
# VITE_TILE_URL=/tiles/{z}/{x}/{y}

# ============================================================
# [선택] SSL/HTTPS 설정
# ============================================================
# SSL 인증서는 ./ssl/ 디렉토리에 배치
# - ./ssl/cert.pem : 인증서 파일
# - ./ssl/key.pem  : 개인키 파일

# HTTPS 포트 (기본값: 443)
# HTTPS_PORT=443

# HTTP를 HTTPS로 리다이렉트 (true/false)
# SSL_REDIRECT=true
